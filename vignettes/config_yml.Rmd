---
title: documentation of options in config.yml
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{config_yml}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Intro

Most of the functions in this package require a path to a `config.yml` file as input. This structure allows for an easily reviewed file that contains all relevant parameters that should be / were used for a given multi-loanbook analysis. Below is a full documentation of each option.

# Preface

The config file is separated into a few top-level "sections" that contain contextually similar options. The top-level sections will be documented as well below, but note that the top-level sections themselves never have a value directly associated with them.

Also note that the config file must have the top-level section `default`. This is related to a feature of the `yaml` package which facilitates having and targeting different config sets for different purposes. Technically, one could leverage this for use with workflow.multi.loanbook, but it is not recommended.

# Options

## directories:

The `directories` section contains options to define locally accessible paths where input and output data should be found or saved. A full example `directories` section might look like:

    directories:
      dir_scenario: "~/Desktop/test/scenario"
      dir_abcd: "~/Desktop/test/abcd"
      dir_raw: "~/Desktop/test/raw"
      dir_matched: "~/Desktop/test/matched"
      dir_output: "~/Desktop/test/output"

#### dir_scenario

`dir_scenario` is a path to a directory that contains scenario data to be used. It must be a single string/character value, and it must refer to a valid, accessible, local directory. As an example:

    dir_scenario: "~/Desktop/test/scenario"

#### dir_abcd

`dir_abcd` is a path to a directory that contains asset based company production data to be used. It must be a single string/character value, and it must refer to a valid, accessible, local directory. As an example:

    dir_abcd: "~/Desktop/test/abcd"

#### dir_raw

`dir_raw` is a path to a directory that contains raw loanbook data to be used. It must be a single string/character value, and it must refer to a valid, accessible, local directory. As an example:

    dir_raw: "~/Desktop/test/raw"

#### dir_matched

`dir_matched` is a path to a directory that contains matched loanbook data to be used. It must be a single string/character value, and it must refer to a valid, accessible, local directory. As an example:

    dir_matched: "~/Desktop/test/matched"

#### dir_output

`dir_output` is a path to a directory where the outputs should be saved. It must be a single string/character value, and it must refer to a valid, accessible, local directory. As an example:

    dir_output: "~/Desktop/test/output"

## file_names:

The `file_names` section contains options to define the file names of locally accessible files found in the directories defined in the `directories` section. The directories and file names are defined separately to allow for flexibility in where and how your input and output files are stored. A full example `file_names` section might look like:

    file_names:
      filename_scenario_tms: "scenarios_2022_p4b.csv"
      filename_scenario_sda: "scenarios_2022_ei_p4b.csv"
      filename_abcd: "2023-02-17_AI_RMI_PACTA for Banks Free dataset_EO_2022Q4.xlsx"
      sheet_abcd: "Company Indicators - PACTA Comp"

#### filename_scenario_tms

`filename_scenario_tms` is the filename of the file that contains production based scenario data. It must be a single string/character value, and it must refer to a valid, accessible, local file. As an example:

    filename_scenario_tms: "scenarios_2022_p4b.csv

#### filename_scenario_sda

`filename_scenario_sda` is the filename of the file that contains emission intensity based scenario data. It must be a single string/character value, and it must refer to a valid, accessible, local file. As an example:

    filename_scenario_sda: "scenarios_2022_ei_p4b.csv"

#### filename_abcd

`filename_abcd` is the filename of the file that contains asset based company production data. It must be a single string/character value, and it must refer to a valid, accessible, local file. As an example:

    filename_abcd: "2023-02-17_AI_RMI_PACTA for Banks Free dataset_EO_2022Q4.xlsx"

#### sheet_abcd

`sheet_abcd` is the name of the sheet that contains asset based company production data in the file defined by `filename_abcd` and stored in the directory defined by `dir_abcd`. It must be a single string/character value, and it must refer to a valid, accessible, sheet name in the appropriate file. As an example:

    sheet_abcd: "Company Indicators - PACTA Comp"
    
### project_parameters:

A full example `project_parameters` section might look like:

    project_parameters:
      scenario_source: "weo_2022"
      scenario_select: "nze_2050"
      region_select: "global"
      # normally the start year should correspond with year of the publication of
      # the scenario in use
      start_year: 2022
      time_frame: 5
      # regions must be available for the selected scenario
      benchmark_regions_select: "global,european union"
      remove_inactive_companies: TRUE

#### scenario_source

`scenario_source` is an identifier of the scenario source to be used. It must be a single string/character value, and it must refer to a valid, accessible, scenario source identifier contained in the scenario data file/s defined by `filename_scenario_tms` and `filename_scenario_sda`. Valid values typically look like "weo_2023" or "geco_2022". As an example:

    scenario_source: "weo_2022"

#### scenario_select

`scenario_select` is an identifier of the scenario to be used. It must be a single string/character value, and it must refer to a valid, accessible, scenario identifier contained in the scenario data file/s defined by `filename_scenario_tms` and `filename_scenario_sda`. Valid values typically look like "nze_2050", "aps" or "steps". As an example:

    scenario_select: "nze_2050"

#### region_select

`region_select` is an identifier of the region to be used. It must be a single string/character value, and it must refer to a valid, accessible, region identifier contained in the `r2dii.data::region_isos` datatset. Valid values typically look like "global" or "advanced economies". As an example:

    region_select: "global"

#### start_year

`start_year` is the start year of the analysis. Normally, the start year should correspond with year of the publication of the scenario in use. It must be a single numeric value, and it must refer to a valid, accessible, year contained in the scenario data file/s defined by `filename_scenario_tms` and `filename_scenario_sda`. Valid values typically look like `2022` or `2023`. As an example:

    start_year: 2022

#### time_frame

`time_frame` is the number of years (starting from the `start_year`) that the analysis covers, defining the time frame. It must be a single numeric value, and it must define a valid, accessible, time frame  covered by the scenario data file/s defined by `filename_scenario_tms` and `filename_scenario_sda`. Valid values typically look like `5` or `6`. As an example:

    time_frame: 5

#### benchmark_regions_select

`benchmark_regions_select` . As an example:

    # regions must be available for the selected scenario
    benchmark_regions_select: "global,european union"

#### remove_inactive_companies

`remove_inactive_companies` . As an example:

    remove_inactive_companies: TRUE

### sector_split:

A full example `sector_split` section might look like:

    sector_split:
      apply_sector_split: TRUE
      sector_split_type: "equal_weights"
      # sector_split_type: "worst_case"
      dir_split_company_id: "~/Desktop/test/split"
      filename_split_company_id: "split_company_ids.csv"
      dir_advanced_company_indicators: "~/data/pactarawdata/asset-impact/2024-02-15_AI_RMI_2023Q4"
      filename_advanced_company_indicators: "2024-02-14_AI_2023Q4_RMI-Company-Indicators.xlsx"
      sheet_advanced_company_indicators: "Company Activities"

#### apply_sector_split

`apply_sector_split` . As an example:

    apply_sector_split: TRUE

#### sector_split_type

`sector_split_type` . As an example:

    sector_split_type: "equal_weights"
    # sector_split_type: "worst_case"

#### dir_split_company_id

`dir_split_company_id` . As an example:

    dir_split_company_id: "~/Desktop/test/split"

#### filename_split_company_id

`filename_split_company_id` . As an example:

    filename_split_company_id: "split_company_ids.csv"

#### dir_advanced_company_indicators

`dir_advanced_company_indicators` . As an example:

    dir_advanced_company_indicators: "~/data/pactarawdata/asset-impact/2024-02-15_AI_RMI_2023Q4"

#### filename_advanced_company_indicators

`filename_advanced_company_indicators` . As an example:

    filename_advanced_company_indicators: "2024-02-14_AI_2023Q4_RMI-Company-Indicators.xlsx"

#### sheet_advanced_company_indicators

`sheet_advanced_company_indicators` . As an example:

    sheet_advanced_company_indicators: "Company Activities"

### matching:

A full example `matching` section might look like:

    matching:
      prep_input_level: "direct_loantaker"
      params_match_name:
        by_sector: TRUE
        min_score: 0.9
        method: "jw"
        p: 0.1
        overwrite: NULL
        join_id: NULL
      own_sector_classification:
        use_own_sector_classification: FALSE
        dir_own_sector_classification: "path/to/own_sector_classification_folder"
        filename_own_sector_classification: "own_sector_classification.csv"

    matching:
      prep_input_level: "direct_loantaker"
      params_match_name:
        by_sector: TRUE
        min_score: 0.9
        method: "jw"
        p: 0.1
        overwrite: NULL
        join_id: NULL
      own_sector_classification:
        use_own_sector_classification: FALSE
        dir_own_sector_classification: "path/to/own_sector_classification_folder"
        filename_own_sector_classification: "own_sector_classification.csv"

### match_prioritize:

A full example `match_prioritize` section might look like:

    match_prioritize:
      priority: NULL

#### priority

`priority` . As an example:

    priority: NULL

### prepare_abcd:

A full example `prepare_abcd` section might look like:

    prepare_abcd:
      remove_inactive_companies: TRUE

#### remove_inactive_companies

`remove_inactive_companies` . As an example:

    remove_inactive_companies: TRUE

### match_success_rate:

A full example `match_success_rate` section might look like:

    match_success_rate:
      plot_width: 12
      plot_height: 8
      plot_units: "in"
      plot_resolution: 300

#### plot_width

`plot_width` . As an example:

    plot_width: 12

#### plot_height

`plot_height` . As an example:

    plot_height: 8

#### plot_units

`plot_units` . As an example:

    plot_units: "in"

#### plot_resolution

`plot_resolution` . As an example:

    plot_resolution: 300

### aggregate_alignment_metric:

A full example `aggregate_alignment_metric` section might look like:

    aggregate_alignment_metric:
      by_group: "group_id"

#### by_group

`by_group` . As an example:

    by_group: "group_id"
