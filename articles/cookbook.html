<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Cookbook • pacta.multi.loanbook</title>
<link rel="icon" type="image/png" sizes="16x16" href="/headshot_placeholder.png">
<link rel="icon" type="image/png" sizes="32x32" href="/headshot_placeholder.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/headshot_placeholder.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Overpass-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cookbook">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-info" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pacta.multi.loanbook</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Methodology</h6></li>
    <li><a class="dropdown-item" href="../articles/company_alignment_metric.html">Calculation of a company alignment metric</a></li>
    <li><a class="dropdown-item" href="../articles/loanbook_aggregated_alignment_metric.html">Calculation of exposure-weighted aggregated alignment metric</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Documentation</h6></li>
    <li><a class="dropdown-item" href="../articles/config_yml.html">Configuring the application</a></li>
    <li><a class="dropdown-item" href="../articles/data_dictionary.html">Understanding the data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Cookbooks</h6></li>
    <li><a class="dropdown-item" href="../articles/cookbook.html">Cookbook</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RMI-PACTA/pacta.multi.loanbook/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Cookbook</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/RMI-PACTA/pacta.multi.loanbook/blob/main/vignettes/cookbook.Rmd" class="external-link"><code>vignettes/cookbook.Rmd</code></a></small>
      <div class="d-none name"><code>cookbook.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This cookbook provides a step-by-step guide to running the PACTA for
Supervisors analysis using the <code>pacta.multi.loanbook</code>
package. The analysis is designed to help financial supervisors assess
the alignment of banks’ loan books with the Paris Agreement goals.</p>
<div class="section level3">
<h3 id="what-is-the-pacta-for-supervisors-analysis">What is the PACTA for Supervisors analysis?<a class="anchor" aria-label="anchor" href="#what-is-the-pacta-for-supervisors-analysis"></a>
</h3>
<p>PACTA for Supervisors is based on the PACTA methodology, which
assesses the alignment of financial portfolios with climate goals
utilizing forward-looking asset-based company data (ABCD) that is linked
to financial assets and compares the production profiles of those
companies with technology and emissions pathways from climate transition
scenarios at the sector and/or technology level.</p>
</div>
<div class="section level3">
<h3 id="who-is-this-tool-built-for">Who is this tool built for?<a class="anchor" aria-label="anchor" href="#who-is-this-tool-built-for"></a>
</h3>
<p>The PACTA for Supervisors analysis is primarily designed to be run by
financial supervisors on their own, with minimal additional guidance.
However, it can also be a useful tool for any other user, in case they
would like to run a PACTA analysis on multiple loan books.</p>
<p>The main difference between this tool and the individual PACTA for
Banks software packages is that this tool aims to facilitate the
analysis of multiple loan books at once, streamlining the process as
much as possible, to keep the burden for the user to a minimum. As such
it is a helpful tool for anyone who would like to run a PACTA analysis
on multiple loan books.</p>
</div>
<div class="section level3">
<h3 id="what-can-the-results-of-the-pacta-for-supervisors-analysis-be-used-for">What can the results of the PACTA for Supervisors analysis be used
for?<a class="anchor" aria-label="anchor" href="#what-can-the-results-of-the-pacta-for-supervisors-analysis-be-used-for"></a>
</h3>
<p>Financial supervisors or regulators can use the results of the
analysis to assess the alignment of banks’ loan books with the Paris
Agreement goals, to identify sectors where banks may need to take action
to improve alignment, and to screen the financial system for potential
climate-related transition risks. The analysis can be parameterised in
different ways to explore patterns across the analysed loan books. If
run by private institutions, the results may additionally be used to
identify opportunities for climate-aligned investments, as well as for
detecting individual counterparties that may be exposed to
climate-related transition risks and may therefore require dedicated
focus in the risk management process.</p>
<p>Users will be able to obtain both tabular outputs and plots that can
be used for any of the above use cases. The tabular output further
enables processing of the alignment results in other models or tools,
for example as an input into financial risk models, or as a recurring
input into internal monitoring systems.</p>
<p>The level of granularity of the outputs allows for a systematic
analysis of climate alignment starting at the financial system level
(across all analyzed loan books together), down to the individual
counterparty level, and across sectors and technologies. Grouping of the
results at any of these levels by additional dimensions can easily be
achieved using the configuration file.</p>
</div>
<div class="section level3">
<h3 id="what-are-the-main-steps-of-the-analysis">What are the main steps of the analysis?<a class="anchor" aria-label="anchor" href="#what-are-the-main-steps-of-the-analysis"></a>
</h3>
<p>The main steps of the analysis are as follows:</p>
<ol style="list-style-type: decimal">
<li>Data preparation: Prepare the ABCD data and optionally a custom
sector split.</li>
<li>Matching process: Match the raw loan books to the ABCD data.</li>
<li>Prioritization of loan books; Match success and coverage
diagnostics: Prioritize the matched loan books and analyze their
coverage.</li>
<li>Run PACTA for Supervisors analysis: Run the analysis based on the
parameters set in the <code>config.yml</code> file.</li>
</ol>
<p>This cookbook will guide you through each of the steps of the
analysis in detail, explain the required input data sets and software,
and provide guidance on how to interpret the results.</p>
</div>
</div>
<div class="section level2">
<h2 id="preparatory-steps">Preparatory Steps<a class="anchor" aria-label="anchor" href="#preparatory-steps"></a>
</h2>
<p>This section provides an overview of the preparatory steps that need
to be taken before running the PACTA for Supervisors analysis. It
includes information on the required input data sets, the required
software, and the how to setup the project folder and file structure.
Finally, it provides a checklist of the steps that need to be taken
before running the analysis, summarizing in brief the steps explained in
more detail before.</p>
<div class="section level3">
<h3 id="required-input-data-sets">Required Input Data Sets<a class="anchor" aria-label="anchor" href="#required-input-data-sets"></a>
</h3>
<p>The PACTA for Supervisors analysis requires a number of input data
sets to run. Some of these can be obtained from external sources, while
others need to be prepared by the user. Furthermore, some of the input
data sets are optional and there inclusion will depend on the settings
provided in the <code>config.yml</code> file.</p>
<p>The main input data sets required for the analysis are the
following:</p>
<div class="section level4">
<h4 id="asset-based-company-data-abcd">Asset-based Company Data (ABCD)<a class="anchor" aria-label="anchor" href="#asset-based-company-data-abcd"></a>
</h4>
<ul>
<li>required input</li>
<li>external source</li>
<li>XLSX file</li>
</ul>
<p>This data set provides information on the production profiles and
emission intensities of companies active in the following real economy
sectors: Automotive (light-duty vehicles) manufacturing, aviation,
cement production, coal mining, upstream oil &amp; gas extraction, power
generation, and steel production. The ABCD is typically obtained from
third party data providers. However, it is possible to prepare the ABCD
yourself or complement an external data set with entries that may not be
covered out of the box.</p>
<p>The ABCD data set must be an XLSX file and contains the following
columns:</p>
<ul>
<li><code>company_id</code></li>
<li><code>name_company</code></li>
<li><code>lei</code></li>
<li><code>is_ultimate_owner</code></li>
<li><code>sector</code></li>
<li><code>technology</code></li>
<li><code>plant_location</code></li>
<li><code>year</code></li>
<li><code>production</code></li>
<li><code>production_unit</code></li>
<li><code>emission_factor</code></li>
<li><code>emission_factor_unit</code></li>
</ul>
<p>Further information on how to obtain ABCD for PACTA and documentation
of the individual sectors and data points can be found here
<strong>LINK</strong>.</p>
</div>
<div class="section level4">
<h4 id="scenario-data">Scenario Data<a class="anchor" aria-label="anchor" href="#scenario-data"></a>
</h4>
<ul>
<li>required input(s)</li>
<li>external source</li>
<li>CSV file(s)</li>
</ul>
<p>The scenario data set provides information on the trajectories of
technologies/fuel types and of emission intensities pathways for each of
(or a subset of) the sectors covered in PACTA.</p>
<p>For sectors with technology level trajectories, the data set provides
the TMSR and SMSP pathways based on the Market Share Approach, an
allocation rule that implies all companies active in a sector have to
adjust their production in a way that keeps market shares constant and
solves for the aggregate climate transition scenario (LINK to the market
share documentation).</p>
<p>The target market share scenario data set must be a CSV file and
contains the following columns:</p>
<ul>
<li><code>scenario_source</code></li>
<li><code>region</code></li>
<li><code>scenario</code></li>
<li><code>sector</code></li>
<li><code>technology</code></li>
<li><code>year</code></li>
<li><code>smsp</code></li>
<li><code>tmsr</code></li>
</ul>
<p>For sectors that do not have technology level pathways, PACTA uses
the Sectoral Decarbonization Approach (SDA), an allocation rule that
implies that all companies in a sector have to converge their physical
emission intensity at a future scenario value - e.g. in the year 2050.
This implies that more polluting companies have to reduce their physical
emissions intensity more drastically than companies using cleaner
technology. It does not have any direct implications on the amount of
units produced by any company (LINK to the SDA documentation).</p>
<p>The SDA scenario data set must be a CSV file and contains the
following columns:</p>
<ul>
<li><code>scenario_source</code></li>
<li><code>region</code></li>
<li><code>scenario</code></li>
<li><code>sector</code></li>
<li><code>year</code></li>
<li><code>emission_factor</code></li>
<li><code>emission_factor_unit</code></li>
</ul>
<p>While the raw input values of the scenarios are based on external
third party organisations - such as the International Energy Agency
(IEA), the Joint Research Center of the European Commission (JRC), or
the Institute for Sustainable Futures (ISF) - the input data set for
PACTA must be prepared using additional steps, which are documented
publicly on the following GitHub repositories:</p>
<ul>
<li><a href="https://github.com/RMI-PACTA/pacta.scenario.data.preparation" class="external-link">pacta.scenario.data.preparation</a></li>
<li><a href="https://github.com/RMI-PACTA/workflow.scenario.preparation" class="external-link">workflow.scenario.preparation</a></li>
</ul>
<p>Since RMI has taken over stewardship of PACTA the prepared scenario
files can also be accessed as CSV downloads the <a href="https://pacta.rmi.org/pacta-for-banks-2020/" class="external-link">PACTA website</a>
under the “Methodology and Documents” tab of the “PACTA for Banks”
section. The files are usually updated annually based on the latest
scenario publications.</p>
</div>
<div class="section level4">
<h4 id="raw-loan-books">Raw Loan Books<a class="anchor" aria-label="anchor" href="#raw-loan-books"></a>
</h4>
<ul>
<li>required input</li>
<li>self-prepared</li>
<li>CSV file(s)</li>
</ul>
<p>The raw loan books are the financial data sets that you would like to
analyze. They contain information on the loans that banks have provided
to companies. As a supervisor, the data required to construct these data
sets will typically be available to you through regulatory filings that
are accessed via internal data bases or similar. As a bank, the data
required will be available in your internal systems.</p>
<p>The raw loan books must be prepared as CSV files and contain at a
minimum the following columns:</p>
<ul>
<li><code>id_loan</code></li>
<li><code>id_direct_loantaker</code></li>
<li><code>name_direct_loantaker</code></li>
<li><code>id_ultimate_parent</code></li>
<li><code>name_ultimate_parent</code></li>
<li><code>loan_size_outstanding</code></li>
<li><code>loan_size_outstanding_currency</code></li>
<li><code>loan_size_credit_limit</code></li>
<li><code>loan_size_credit_limit_currency</code></li>
<li><code>sector_classification_system</code></li>
<li><code>sector_classification_direct_loantaker</code></li>
<li><code>lei_direct_loantaker</code></li>
<li><code>isin_direct_loantaker</code></li>
</ul>
<p><strong>NOTE:</strong> The tool will automatically add a column
<code>group_id</code> to each of the loan books, which uses the file
name as a value. This allows you to group the results the analysis by
loan book, using the <code>by_group</code> parameter in the
<code>config.yml</code> file. For any other variable that you may want
to group the results by, you need to add a column to the raw loan book
files that you then provide as the <code>by_group</code> parameter in
the <code>config.yml</code> file.</p>
<p>For detailed descriptions of how to prepare raw loan books, see the
<a href="https://pacta.rmi.org/pacta-for-banks-2020/" class="external-link">PACTA for Banks
documentation</a> and navigate to the “Training Materials” tab of the
“PACTA for Banks” section. The <em>“User Guide 2”</em>, the <em>“Data
Dictionary”</em>, and the <em>“Loan Book Template”</em> files can all be
helpful in preparing your data.</p>
<p><strong>TODO:</strong> check if the relevant documents are up to
date</p>
</div>
<div class="section level4">
<h4 id="misclassified-loans">Misclassified Loans<a class="anchor" aria-label="anchor" href="#misclassified-loans"></a>
</h4>
<ul>
<li>optional input</li>
<li>self-prepared</li>
<li>CSV file</li>
</ul>
<p>The user can provide a list of loans that have been misclassified in
the raw loan books. The aim here is specifically to remove false
positives, that is, loans that are classified in scope of one of the
PACTA sectors, but where manual research shows that the companies do not
actually operate within the PACTA scope. Such a false positive may be
due to erroneous data entry in the raw loan book, for example. Removing
these loans from the falsely indicated sector in the calculation of the
match success rate will give a more accurate picture of what match
success rate can really be reached.</p>
</div>
<div class="section level4">
<h4 id="asset-based-company-data-abcd-for-company-sector-split">Asset-Based Company Data (ABCD) for company sector split<a class="anchor" aria-label="anchor" href="#asset-based-company-data-abcd-for-company-sector-split"></a>
</h4>
<ul>
<li>optional input</li>
<li>external source</li>
<li>XLSX file</li>
</ul>
<p>In case the user wants to split company exposures across sectors of
in scope activity, the user must provide a version of the ABCD data set
that follows the format of the Advanced Company Indicators data set by
Asset Impact. This data set includes power generation values which are
required for the primary energy based sector split.</p>
</div>
<div class="section level4">
<h4 id="companies-to-apply-primary-energy-split-on">Companies to apply primary energy split on<a class="anchor" aria-label="anchor" href="#companies-to-apply-primary-energy-split-on"></a>
</h4>
<ul>
<li>optional input</li>
<li>self-prepared</li>
<li>CSV file</li>
</ul>
<p>When applying the sector split on company exposures, the user can
provide a list of companies for which the sector split should be based
on primary energy content. For all other companies, a simple equal
weights split will be applied. For more information on the sector split,
see the <a href="https://github.com/RMI-PACTA/workflow.aggregate.loanbooks?tab=readme-ov-file#optional-calculate-sector-splits-for-multi-sector-companies" class="external-link">documentation</a>.</p>
<p><strong>TODO:</strong> Move the sector split documentation to this
repo!</p>
</div>
<div class="section level4">
<h4 id="manual-sector-classification">Manual Sector Classification<a class="anchor" aria-label="anchor" href="#manual-sector-classification"></a>
</h4>
<ul>
<li>optional input</li>
<li>self-prepared</li>
<li>CSV file</li>
</ul>
<p><strong>TODO:</strong> Add once we have a stable implementation of
this feature</p>
</div>
</div>
<div class="section level3">
<h3 id="required-software">Required Software<a class="anchor" aria-label="anchor" href="#required-software"></a>
</h3>
<p>Using the <code>pacta.multi.loanbook</code> package for the PACTA for
Supervisors analysis requires the following software to be installed on
your system:</p>
<div class="section level4">
<h4 id="r-version-4-1-0-or-higher">R (version 4.1.0 or higher)<a class="anchor" aria-label="anchor" href="#r-version-4-1-0-or-higher"></a>
</h4>
<p>R is the programming language that the
<code>pacta.multi.loanbook</code> package is written in. You can
download R from the <a href="https://cran.r-project.org/" class="external-link">Comprehensive
R Archive Network (CRAN)</a>.</p>
</div>
<div class="section level4">
<h4 id="rstudio-optional">RStudio (optional)<a class="anchor" aria-label="anchor" href="#rstudio-optional"></a>
</h4>
<p>RStudio is an integrated development environment (IDE) for R
developed by Posit. It is not strictly required to run the analysis, but
it can be helpful for managing your project and running the analysis.
Generally, RStudio is very widely used among the R cummunity and
probably the easiest way to interact with most R tools, such as
<code>pacta.multi.loanbook</code>. RStudio Desktop is an open source
tool and free of charge. You can download RStudio from the <a href="https://posit.co/downloads/" class="external-link">Posit RStudio website</a>.</p>
</div>
<div class="section level4">
<h4 id="pacta-multi-loanbook-r-package">
<code>pacta.multi.loanbook</code> R package<a class="anchor" aria-label="anchor" href="#pacta-multi-loanbook-r-package"></a>
</h4>
<p>The <code>pacta.multi.loanbook</code> package is the main software
tool that you will use to run the PACTA for Supervisors analysis. You
can install the package from the <a href="https://cran.r-project.org/web/packages/pacta.multi.loanbook/index.html" class="external-link">RStudio
CRAN mirror</a> by running the following command in R:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"pacta.multi.loanbook"</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, you can install the development version of the package
from GitHub by running the following command in R:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"RMI-PACTA/pacta.multi.loanbook"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="required-r-packages">Required R packages<a class="anchor" aria-label="anchor" href="#required-r-packages"></a>
</h4>
<p>The <code>pacta.multi.loanbook</code> package depends on a number of
other R packages. These dependencies will be installed automatically
when you install the <code>pacta.multi.loanbook</code> package. The
required packages are:</p>
<pre><code><span><span class="co">#&gt; cli (&gt;= 3.2.0), config, dplyr, ggplot2, glue, networkD3,</span></span>
<span><span class="co">#&gt; r2dii.analysis, r2dii.data (&gt;= 0.5.0), r2dii.match, r2dii.plot</span></span>
<span><span class="co">#&gt; (&gt;= 0.4.0), readr (&gt;= 2.0.0), readxl, rlang, scales, tidyr,</span></span>
<span><span class="co">#&gt; webshot, withr</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="suggested-r-packages">Suggested R packages<a class="anchor" aria-label="anchor" href="#suggested-r-packages"></a>
</h4>
<p>The suggested packages are not required to run the analysis, but they
are used in the examples and vignettes provided with the package:</p>
<pre><code><span><span class="co">#&gt; gt, knitr, pkgdown, rmarkdown, usethis, testthat (&gt;= 3.1.9),</span></span>
<span><span class="co">#&gt; tibble, writexl</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="faq">FAQ<a class="anchor" aria-label="anchor" href="#faq"></a>
</h4>
<div class="section level5">
<h5 id="how-do-i-install-the-pacta-multi-loanbook-package">How do I install the <code>pacta.multi.loanbook</code> package?<a class="anchor" aria-label="anchor" href="#how-do-i-install-the-pacta-multi-loanbook-package"></a>
</h5>
<p>The most common ways to install R packages are via CRAN or GitHub.
Public institutions often have restrictions on the installation of
packages from GitHub, so you may need to install the package from CRAN.
In some cases, your institution may mirror CRAN in their internal
application registry, so you may need to install the package from there.
Should you have any issues with the installation from the internal
application registry, it is best to reach out to your IT department. If
you cannot obtain the package any of these ways, please reach out to the
package maintainers directly for exploring other options.</p>
</div>
<div class="section level5">
<h5 id="how-do-i-install-the-required-r-packages">How do I install the required R packages?<a class="anchor" aria-label="anchor" href="#how-do-i-install-the-required-r-packages"></a>
</h5>
<p>In principle, all dependencies required to run the
<code>pacta.multi.loanbook</code> package will be installed
automatically when you install the package. However, if you encounter
any issues with the installation of the required packages, you can
install them manually by running the following command in R, where …
should be replaced with the package names from the list above, separated
by commas:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="project-setup">Project Setup<a class="anchor" aria-label="anchor" href="#project-setup"></a>
</h3>
<div class="section level4">
<h4 id="config">Config<a class="anchor" aria-label="anchor" href="#config"></a>
</h4>
<p>All of the functions needed to run a PACTA for Supervisors analysis
take a <code>config</code> argument, which can either be a path to a
<code>config.yml</code> file (see <code><a href="../articles/config_yml.html">vignette("config_yml")</a></code>)
or a config list object containing previously imported settings from a
<code>config.yml</code> file. All of the settings/options are configured
with this <code>config.yml</code> file.</p>
</div>
<div class="section level4">
<h4 id="inputoutput-folder-structure">Input/Output folder structure<a class="anchor" aria-label="anchor" href="#inputoutput-folder-structure"></a>
</h4>
<p>The <code>config.yml</code> file then points to an input and an
output directory that the user can choose anywhere on their system, as
long as R has read and write access to these directories. A
recommendable choice to structure an analysis project would be to place
both these folders and the <code>config.yml</code> file in a project
folder. The input folder must contain all input files as described
above, with the raw loan books being placed in a sub-directory that must
be named <code>"loanbooks"</code>. The output folder can remain empty.
It will be populated by running the analysis.</p>
<p>An example of how the project folder could be structured:</p>
<pre><code>project_folder
├── config.yml
├── input
│   ├── loanbooks
│   │   ├── raw_loanbook_1.csv
│   │   ├── raw_loanbook_2.csv
│   │   └── ...
│   ├── ABCD.xlsx
│   ├── scenario_data_tms.csv
│   ├── scenario_data_sda.csv
│   └── ...
└── output</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="checklist-of-preparatory-steps">Checklist of Preparatory Steps<a class="anchor" aria-label="anchor" href="#checklist-of-preparatory-steps"></a>
</h3>
<p>Before running the PACTA for Supervisors analysis, you should make
sure that you have completed the following preparatory steps:</p>
<ul class="task-list">
<li>
<label><input type="checkbox">Obtained the required external input
data sets:</label>
<ul class="task-list">
<li><label><input type="checkbox">Asset-based Company Data
(ABCD)</label></li>
<li><label><input type="checkbox">Scenario Data</label></li>
</ul>
</li>
<li>
<label><input type="checkbox">Prepared the required input data
sets:</label>
<ul class="task-list">
<li><label><input type="checkbox">Raw Loan Books</label></li>
</ul>
</li>
<li>
<label><input type="checkbox">OPTIONAL - Obtained the optional
external input data sets:</label>
<ul class="task-list">
<li><label><input type="checkbox">Asset-based Company Data (ABCD) for
company sector split</label></li>
</ul>
</li>
<li>
<label><input type="checkbox">OPTIONAL - Prepared the optional
input data sets:</label>
<ul class="task-list">
<li><label><input type="checkbox">Companies to apply primary energy
split on</label></li>
<li><label><input type="checkbox">Misclassified Loans</label></li>
<li><label><input type="checkbox">Manual Sector
Classification</label></li>
</ul>
</li>
<li>
<label><input type="checkbox">Installed the required
software:</label>
<ul class="task-list">
<li><label><input type="checkbox">R (version 4.1.0 or
higher)</label></li>
<li><label><input type="checkbox">RStudio (optional)</label></li>
<li><label><input type="checkbox"><code>pacta.multi.loanbook</code> R
package</label></li>
</ul>
</li>
<li>
<label><input type="checkbox">Installed the required R
packages:</label>
<ul class="task-list">
<li><label><input type="checkbox"><code>pacta.multi.loanbook</code>
dependencies</label></li>
</ul>
</li>
<li>
<label><input type="checkbox">OPTIONAL - Installed the suggested R
packages:</label>
<ul class="task-list">
<li><label><input type="checkbox"><code>pacta.multi.loanbook</code>
suggests</label></li>
</ul>
</li>
<li>
<label><input type="checkbox">Setup the project folder and file
structure:</label>
<ul class="task-list">
<li><label><input type="checkbox">Created a project
folder</label></li>
<li><label><input type="checkbox">Created a <code>config.yml</code>
file and placed it in the project folder</label></li>
<li><label><input type="checkbox">Created an <code>input</code> folder
in the project folder</label></li>
<li><label><input type="checkbox">Placed the raw loan books in the
<code>input/loanbooks</code> sub-directory</label></li>
<li><label><input type="checkbox">Placed the other input data sets in
the <code>input</code> folder</label></li>
<li><label><input type="checkbox">Created an <code>output</code>
folder in the project folder</label></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="running-the-analysis">Running the Analysis<a class="anchor" aria-label="anchor" href="#running-the-analysis"></a>
</h2>
<p>This section provides a step-by-step guide to running the PACTA for
Supervisors analysis using the <code>pacta.multi.loanbook</code>
package. It includes information on the structure of the workflow, the
required functions, and the interpretation of the results.</p>
<div class="section level3">
<h3 id="structure-of-the-workflow">Structure of the Workflow<a class="anchor" aria-label="anchor" href="#structure-of-the-workflow"></a>
</h3>
<p>The PACTA for Supervisors analysis consists of four main steps:</p>
<ul>
<li>Data preparation: Preparing the input data sets for the requirements
of the analysis.</li>
<li>Matching process: Matching the raw loan books to the ABCD data and
validating the matches manually.</li>
<li>Prioritization of loan books: Selecting the correct matches for
further analysis and diagnosing match success and coverage
statistics</li>
<li>Run PACTA for Supervisors analysis: Running the analysis based on
the parameters set in the <code>config.yml</code> file to generate the
production-based alignment analysis.</li>
</ul>
<p>The following diagram illustrates the structure of the workflow:</p>
<div class="float">
<img src="../reference/figures/logo.png" alt="structure of the PACTA for Supervisors analysis"><div class="figcaption">structure of the PACTA for Supervisors
analysis</div>
</div>
<p>The following sub sections will provide detailed information on each
of the steps of the analysis, starting with a brief explanation of the
setup, as each of the functions will require the path to the
<code>config.yml</code> file as an input argument.</p>
<div class="section level4">
<h4 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h4>
<p>If you run PACTA for Supervisors interactively or from a script you
may have prepared, you will likely want to load the
<code>pacta.multi.loanbook</code> package and save the path to the
<code>config.yml</code> file in a variable first:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rmi-pacta.github.io/pacta.multi.loanbook/">pacta.multi.loanbook</a></span><span class="op">)</span></span>
<span><span class="va">config_path</span> <span class="op">&lt;-</span> <span class="st">"config.yml"</span></span></code></pre></div>
<p>This allows you passing the relevant config information easily to
each of the four main functions.</p>
</div>
<div class="section level4">
<h4 id="data-preparation">Data preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h4>
<p>The first step of the analysis is to prepare your input data sets for
the requirements of the analysis. Your ABCD data will need to be
prepared and you can optionally use a custom sector split, that will
also need to be prepared. The relevant function is
<code><a href="../reference/prepare_abcd.html">prepare_abcd()</a></code>, which takes configurations from the
<code>config.yml</code> that you have prepared. The function will store
intermediary files in a sub-directory, <code>prepare_abcd</code>, in
your <code>output</code> folder. This step only has to be run once for
an analysis. You can run this function as follows:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pacta.multi.loanbook</span><span class="fu">::</span><span class="fu"><a href="../reference/prepare_abcd.html">prepare_abcd</a></span><span class="op">(</span><span class="va">config_path</span><span class="op">)</span></span></code></pre></div>
<div class="section level5">
<h5 id="options-for-the-prepare_abcd-function">Options for the <code>prepare_abcd()</code> function<a class="anchor" aria-label="anchor" href="#options-for-the-prepare_abcd-function"></a>
</h5>
<p>The <code><a href="../reference/prepare_abcd.html">prepare_abcd()</a></code> function has a number of options that
can be set in the <code>config.yml</code> file. These options
include:</p>
<ul>
<li>whether or not inactive companies should be removed from the ABCD
data (For more information on the options available, see the <a href="https://rmi-pacta.github.io/pacta.multi.loanbook/articles/config_yml.html#prepare_abcd">relevant
section on preparing the ABCD</a> in the
<code><a href="../articles/config_yml.html">vignette("config_yml")</a></code>.)</li>
<li>if and how a company sector split should be applied in the
calculations (For more information on the options available, see the <a href="https://rmi-pacta.github.io/pacta.multi.loanbook/articles/config_yml.html#sector_split">relevant
section on the sector split</a> in the
<code><a href="../articles/config_yml.html">vignette("config_yml")</a></code>). Additionally, see the <a href="https://github.com/RMI-PACTA/workflow.aggregate.loanbooks?tab=readme-ov-file#methodological-note-sector-split-for-energy-companies" class="external-link">documentation
of the sector split methodology</a>.</li>
</ul>
<!--- TODO: move sector split documentation to this repository-->
</div>
</div>
<div class="section level4">
<h4 id="matching-process">Matching process<a class="anchor" aria-label="anchor" href="#matching-process"></a>
</h4>
<p>The next step in the analysis is to run the matching process.
Assuming you have prepared the raw loan books as explained in <a href="#id_##%20Raw%20Loan%20Books">the section on preparing the input
data sets</a>, you can now use the <code><a href="../reference/match_loanbooks.html">match_loanbooks()</a></code>
function. This will read the raw loan books from your inputs and attempt
to match them to the prepared ABCD data from the previous step. The
function will store matched loan book files in a sub-directory,
<code>matched_loanbooks</code>, in your <code>output</code> folder. You
can run this function as follows:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pacta.multi.loanbook</span><span class="fu">::</span><span class="fu"><a href="../reference/match_loanbooks.html">match_loanbooks</a></span><span class="op">(</span><span class="va">config_path</span><span class="op">)</span></span></code></pre></div>
<p>After the matching process is complete, you will need to do some
manual matching. This means that you will need to manually inspect the
suggested matches that the tool has found and decide which ones to keep
or to remove. This is especially important when using text based
matching, as there is no guarantee that similar company names as
identified by the algorithms will actually refer to the same companies
in the raw loan books and the ABCD. Thus, a manually validation step is
crucial in the analysis, as the quality of the matches will determine
the quality of the results of any further calculations.</p>
<p>The manual matching process is not automated and will require some
time and effort on your part. You can find the matched loan books in the
<code>output/matched_loanbooks</code> folder. The matched loan books
will be stored in CSV files, one for each raw loan book. You can open
these files in a spreadsheet program to verify the matches. Importantly,
you will need to make a copy for each of the matched loan book files in
the same <code>output/matched_loanbooks</code> folder and rename that
copy by adding the suffix <code>_manual</code> to the file name. The
following steps of the analysis expect this pattern, so it is important
to follow this naming convention.</p>
<p>You can find more detaied information about the matching process in
the training material on the <a href="https://pacta.rmi.org/pacta-for-banks-2020/" class="external-link">PACTA for Banks
website</a> in the section “PACTA for Banks Training Webinar 2” and in
the <a href="https://pacta.rmi.org/wp-content/uploads/2020/12/PACTA-for-Banks-Training-Webinar-2-Matching-a-loan-book-to-physical-assets-in-the-real-economy-.pdf" class="external-link">corresponding
slide deck</a>.</p>
<div class="section level5">
<h5 id="some-expectations-for-the-matching-process">Some expectations for the matching process<a class="anchor" aria-label="anchor" href="#some-expectations-for-the-matching-process"></a>
</h5>
<ul>
<li>It is unlikely that you will be able to match all of the loans from
your raw loan books to the ABCD data set. This is expected and has the
following reasons:
<ul>
<li>Raw loan books often include companies that are not in scope of the
PACTA analysis, for example there may be companies active in the
financial sector or in manufacturing of IT products. Both these sectors
are fully out of scope. There may also be companies that are active in
upstream or downstream activities of the sectors covered by PACTA. This
means that the company activities are not at the part of the value chain
that is covered my PACTA and accordingly the companies are not matched.
Examples for this are power distribution companies or companies that
manufacture air crafts.</li>
<li>The ABCD data set may not cover all companies that are in scope of
the PACTA analysis. While coverage of the real economy sectors is
usually rather high in the data sets that are commonly used for PACTA,
there are gaps. This implies that some in-scope companies cannot be
matched because the ABCD data set does not include them. Advanced users
may research the production profiles of such companies by themselves and
add them to the ABCD data manually, however this is a very involved
process and not standard procedure and will therefore not be covered in
this cookbook.</li>
<li>If you are using sector classifications for the matching process
(which is recommended whenever possible), some matches may not be
identified in case the companies in the raw loan book are misclassified.
For example, if a utility that is focused on coal-fired power generation
is classified as a coal mining company, the matching function will not
suggest a match.</li>
</ul>
</li>
<li>Given that it is unlikely to match all loans, it is recommended to
try and match the companies with the largest financial exposures first,
as this ensures the best possible financial coverage of the loan book in
the analysis.</li>
<li>It is also recommended to run multiple iterations of the matching
process, potentially adjusting the matching parameters in the
<code>config.yml</code> file, to see if you can improve the match
success rate. The match success rate can be obtained based on the
manually validated matched loan books and the raw loan books as
described in <a href="#id_##%20Prioritization%20of%20loan%20books;%20Match%20success%20and%20coverage%20diagnostics">the
next section on prioritization and diagnostics</a>.</li>
</ul>
</div>
<div class="section level5">
<h5 id="options-for-the-match_loanbooks-function">Options for the <code>match_loanbooks()</code> function<a class="anchor" aria-label="anchor" href="#options-for-the-match_loanbooks-function"></a>
</h5>
<p>The <code><a href="../reference/match_loanbooks.html">match_loanbooks()</a></code> function has a number of options
that can be set in the <code>config.yml</code> file. These options
include:</p>
<ul>
<li>specifications for the approach to matching the raw loan book with
the ABCD <a href="https://rmi-pacta.github.io/pacta.multi.loanbook/articles/config_yml.html#matching">relevant
section on matching</a> in the <code><a href="../articles/config_yml.html">vignette("config_yml")</a></code>).
Note that these parameters are all based on the
<code><a href="https://rmi-pacta.github.io/r2dii.match/reference/match_name.html" class="external-link">r2dii.match::match_name</a></code> function and pass the parameters
directly to that function. For more information on the options
available, see the <a href="https://rmi-pacta.github.io/r2dii.match/reference/match_name.html" class="external-link">documentation
of the r2dii.match package</a>. This also covers matching based on
unique identifiers, which is the most reliable way to match companies,
but requires that both the raw loan books and the ABCD contain such
identifiers.</li>
<li>whether to use a manually prepared sector classification system for
matching the loan books to in-scope PACTA sectors, see the <a href="https://rmi-pacta.github.io/pacta.multi.loanbook/articles/config_yml.html#matching">relevant
section on matching</a> in the <code><a href="../articles/config_yml.html">vignette("config_yml")</a></code>), or
not. If not, the sector classification systems provided in
<code><a href="https://rmi-pacta.github.io/r2dii.data/reference/sector_classifications.html" class="external-link">r2dii.data::sector_classifications</a></code> can be used.</li>
</ul>
</div>
<div class="section level5">
<h5 id="addressing-misclassfied-loans">Addressing misclassfied loans<a class="anchor" aria-label="anchor" href="#addressing-misclassfied-loans"></a>
</h5>
<p>There are two ways to appropriately handle misclassified loans that
are identified as in-scope in the raw data set but are then not
matched.</p>
<ol style="list-style-type: decimal">
<li>Correct the classification in the raw loan book and re-run the
matching process. If the loan was clearly mis-classified, this may be
the most appropriate way to handle the issue. It may be a good idea to
record any such changes made in the input data though. The upsdie of
this approach is that the loan will now either be matched correctly, as
it will be assigned the sector that the company should have and
therefore find an entry in the ABCD data set to match against. Or, if
there is still no match to be found in the ABCD, the loan will correctly
be missing in the appropriate sector and therefore indicate a lower
match success rate where it should.</li>
<li>If a manual re-classification of the raw loan book is not possible
or desired, the calculation of the match success rate can be corrected
by adding a file <code>loans_to_remove.csv</code> to the input
directory. This file should include the columns <code>id_loan</code> and
<code>group_id</code> to indicate the precise mis-classified loan and
the loan book in which it was found. This combnation of loan and loan
book will then be excluded from the match success calculation.</li>
</ol>
<p>The reason why it is a good idea to either correct mis-classified
loans or disregard them in the calculation of the match success rate is
that a mis-classified loan cannot possibly be matched in a given sector.
Therefore, no amount of work would be sufficient to improve the sector
match success rate, because it is calculated against an incorrect
baseline. Technically, the user is not forced to correct
misclassifications, and there may be a limit to how much time should be
spent on this, but it is recommended to at least correct large
mis-classified loans.</p>
</div>
</div>
<div class="section level4">
<h4 id="prioritization-of-loan-books-match-success-and-coverage-diagnostics">Prioritization of loan books; Match success and coverage
diagnostics<a class="anchor" aria-label="anchor" href="#prioritization-of-loan-books-match-success-and-coverage-diagnostics"></a>
</h4>
<p>The next step is to prioritize the manually verified matched loan
books and analyze their coverage, both relative to the raw loan book
inputs (the “match success rate”) and to the production capacity in the
wider economy (the “loan book production coverage”). Prioritizing the
loan books means that you will only keep the best identified match for
each loan and use that in the following steps of the analysis.</p>
<p>You will probably want to check the status of your loan book and
production coverage several times, as it is rare to get to the desired
level of matching in one iteration. This means you may want to repeat
the previous step (matching the loan books, likely using different
parameters for different iterations) and this step (prioritizing the
matched loan books and analyzing their match success rate) a number of
times to reach the best possible outcome. To prioritize your matched
loan books and calculate display the coverage diagnostics, you will use
the <code><a href="../reference/prioritise_and_diagnose.html">prioritise_and_diagnose()</a></code> function. This call will
store matched prioritized loan book files and coverage diagnostics in a
sub-directory, <code>prioritized_loanbooks_and_diagnostics</code>, in
your <code>output</code> folder. You can then run the function as
follows:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pacta.multi.loanbook</span><span class="fu">::</span><span class="fu"><a href="../reference/prioritise_and_diagnose.html">prioritise_and_diagnose</a></span><span class="op">(</span><span class="va">config_path</span><span class="op">)</span></span></code></pre></div>
<div class="section level5">
<h5 id="options-for-the-prioritise_and_diagnose-function">Options for the <code>prioritise_and_diagnose()</code> function<a class="anchor" aria-label="anchor" href="#options-for-the-prioritise_and_diagnose-function"></a>
</h5>
<p>The <code><a href="../reference/prioritise_and_diagnose.html">prioritise_and_diagnose()</a></code> function has a number of
options that can be set in the <code>config.yml</code> file. These
options include:</p>
<ul>
<li>the option to set a specific order for prioritizing the matches.
This is an option that is passed directly to the
<code><a href="https://rmi-pacta.github.io/r2dii.match/reference/prioritize.html" class="external-link">r2dii.match::prioritize</a></code> function. <code>NULL</code> is a
valid default value and is usually a setting that works well, at least
as a starting point. For more information, see the <a href="https://rmi-pacta.github.io/pacta.multi.loanbook/articles/config_yml.html#match_prioritize">relevant
section on the prioritization of matched loan books</a> in the
<code><a href="../articles/config_yml.html">vignette("config_yml")</a></code> or the <a href="https://rmi-pacta.github.io/r2dii.match/reference/prioritize.html" class="external-link">documentation
of the r2dii.match::prioritize() function here</a>.</li>
</ul>
</div>
</div>
<div class="section level4">
<h4 id="run-pacta-for-supervisors-analysis">Run PACTA for Supervisors analysis<a class="anchor" aria-label="anchor" href="#run-pacta-for-supervisors-analysis"></a>
</h4>
<p>The final step is running the analysis based on the parameters you
have set in the <code>config.yml</code> file. This entails both a
standard PACTA for Banks analysis and the calculation of the net
aggregate alignment metric. For both parts of the analysis, outputs will
be stored in the sub-directories <code>analysis/standard</code> (for
standard PACTA for Banks results) and <code>analysis/aggregated/</code>
for the net aggregate alignment metric in your <code>output</code>
folder and comprise tabular outputs and plots. To run the analysis on
all of your previously matched and prioritized loan books, you will use
the <code><a href="../reference/analyse.html">analyse()</a></code> function as follows:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pacta.multi.loanbook</span><span class="fu">::</span><span class="fu"><a href="../reference/analyse.html">analyse</a></span><span class="op">(</span><span class="va">config_path</span><span class="op">)</span></span></code></pre></div>
<div class="section level5">
<h5 id="options-for-the-analysis-function-and-the-overall-analysis">Options for the <code>analysis()</code> function and the overall
analysis<a class="anchor" aria-label="anchor" href="#options-for-the-analysis-function-and-the-overall-analysis"></a>
</h5>
<p>The <code>analysis()</code> function has a number of options that can
be set in the <code>config.yml</code> file. These options include:</p>
<ul>
<li>which source should be used for allocating climate transition
scenario pathways to the companies and loan books. This refers to the
relevant scenario publication and usually contains the name and the year
of the publication, e.g.: <code>"weo_2023"</code> or
<code>"geco_2023"</code>.</li>
<li>which scenario should be used for reference in the net aggregate
alignment metric. This must be a scenario that is included in the source
indicated above.</li>
<li>which region to use as a reference for the analysis. This will
filter the underlying production capacity to assets in the relevant
region and will measure alignment against the scenario trajectory for
the relevant region. It must therefore be a region, for which scenario
data is available in the source selected above.</li>
<li>the start year of the analysis. This must be a year that is
available both in the ABCD data and for which the scenario data has been
prepared. The loan book data is assumed to be a snapshot of the end of
the same year.</li>
<li>the time frame of the analysis, which refers to the number of
forward looking years after the start year that are to be considered in
the alignment analysis. Usually this time frame is set to 5 years.
Specifically, it must be a time frame for which scenario data values and
ABCD data values are available for all sectors that are to be analyzed.
There are not many cases, in which it is expected to change the time
frame to something else than its default value of 5 years.</li>
<li>by which variables to group the loan books to produce grouped
results of the analysis. This parameter is used across multiple steps of
the analysis, both in the diagnostics and in the analysis. This is
because it slices and/or aggregates the loan books such that the
analysis will produce results along the indicated dimension. If no
<code>by_group</code> parameter is passed (i.e. <code>NULL</code>), all
loan books will be aggregated. Otherwise, loan books can either be kept
separate (<code>group_id</code>) or grouped by any other variable that
is provided in each of the raw loan books.
<!---TODO: maybe some of the project_parameters should be in the config section analysis, if thei are not used in other parts of the workflow--->
</li>
</ul>
<p>All these options are documented in more detail the <a href="https://rmi-pacta.github.io/pacta.multi.loanbook/articles/config_yml.html#project_parameters">section
on project parameters</a> in the
<code><a href="../articles/config_yml.html">vignette("config_yml")</a></code>.</p>
<p>Usually, it will be interesting to run the analysis for more than one
by_group, possibly also for multiple combinations of the other
parameters. You will therefore have to run the analysis as many times as
there are combinations of interest that you wish to generate results
for.</p>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="interpretation-of-results">Interpretation of Results<a class="anchor" aria-label="anchor" href="#interpretation-of-results"></a>
</h2>
<div class="section level3">
<h3 id="data-dictionary">Data Dictionary<a class="anchor" aria-label="anchor" href="#data-dictionary"></a>
</h3>
</div>
<div class="section level3">
<h3 id="interpreting-the-coverage-diagnostics">Interpreting the Coverage Diagnostics<a class="anchor" aria-label="anchor" href="#interpreting-the-coverage-diagnostics"></a>
</h3>
</div>
<div class="section level3">
<h3 id="interpreting-the-pacta-outputs-and-graphs">Interpreting the PACTA Outputs and Graphs<a class="anchor" aria-label="anchor" href="#interpreting-the-pacta-outputs-and-graphs"></a>
</h3>
</div>
<div class="section level3">
<h3 id="interpreting-the-net-aggregate-alignment-metric-outputs-and-graphs">Interpreting the Net Aggregate Alignment Metric Outputs and
Graphs<a class="anchor" aria-label="anchor" href="#interpreting-the-net-aggregate-alignment-metric-outputs-and-graphs"></a>
</h3>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="../rmi_logo_stacked_tag_white.svg" alt="RMI logo">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://pacta.rmi.org/" target="_blank" class="external-link"><div class="icon fa fa-link"></div></a>
                        <a href="https://github.com/RMI-PACTA" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://twitter.com/RockyMtnInst" target="_blank" class="external-link"><div class="icon fab fa-twitter"></div></a>
                        <a href="https://www.linkedin.com/showcase/rmi-pacta/" target="_blank" class="external-link"><div class="icon fab fa-linkedin-in"></div></a>
                    </div>
                </div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>© RMI</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>
</div>
<!-- / end footer -->

    
   





  </body>
</html>
